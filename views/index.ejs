<!DOCTYPE html>
<html>
    <head>
        <%- include('module/head'); %>
    </head>
    <body class="" data-layout="detached" data-layout-config='{"leftSidebarCondensed":false,"darkMode":false, "showRightSidebarOnStart": true}'>
        <%- include('module/topbar'); %>

        <!-- Start Content-->
        <div class="container-fluid">

            <!-- Begin page -->
            <div class="wrapper">

                <%- include('module/leftsidebar'); %>
                <div class="content-page">
                    <div class="content">

                        <!-- start page title -->
                        <div class="row">
                            <div class="col-12">
                                <div class="page-title-box">
                                    <h4 class="page-title">Dashboard</h4>
                                </div>
                            </div>
                        </div>
                        <!-- end page title -->    
                
                        <!-- start first row -->
                        <div class="row">
                            <div class="col-xl-5 col-lg-6">

                                <div class="row">
                                    <div class="col-lg-12">
                                        <div class="card widget-flat">
                                            <div class="card-body">
                                                <h5 class="text-muted font-weight-normal mt-0" title="Number of Orders">최근 과제 그룹 총 점수</h5>
                                                <h3 class="mt-3 mb-3"><%= recentHomeworkGroupScore %></h3>
                                            </div> <!-- end card-body-->
                                        </div> <!-- end card-->
                                    </div> <!-- end col-->
                                </div> <!-- end row -->

                                <div class="row">
                                    <div class="col-lg-12">
                                        <div class="card widget-flat">
                                            <div class="card-body">
                                                <h5 class="text-muted font-weight-normal mt-0" title="Average Revenue">선생님 한 마디</h5>
                                                <h3 class="mt-3 mb-3"><%= today %></h3>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div> <!-- end col -->

                            <div class="col-xl-7  col-lg-6">
                                <div class="card">
                                    <div class="card-body">
                                        <h4 class="header-title">우리 반 과제 총 점수</h4>
                                        <img src="/images/main_total.png" alt="total_score" style="width:250px; height:250px; display: block; margin-left: auto; margin-right: auto;">
                                        <div class="div-centered-ts"><%= totalScore %></div>
                                    </div> <!-- end card-body-->
                                </div> <!-- end card-->

                            </div> <!-- end col -->
                        </div>
                        <!-- end row -->

                        <!-- start top row -->
                        <% bestStudents.forEach(obj => { %>

                        <div class="row">
                            <div class="col-lg-12">
                                <div class="card">
                                    <div class="card-body">
                                            <h3 class="header-title mb-3"><%= obj.title %></h4>
                                            <% if(obj.students === undefined || obj.students.length == 0) { %>
                                                <h5>과제왕이 없는 한 주였어요.</h5>
                                            <% } else { %> 
                                                <div class="chart-content-bg">
                                                    <div class="row text-center">
                                                        <% obj.students.forEach(student => { %>
                                                        <div class="col-md-3">
                                                            <img src="/images/top.png" alt="top" style="width:200px; height:200px;">
                                                            <div class="div-centered-top">
                                                                <span><%= student.name %></span>
                                                            </div>
                                                            <div class="div-centered-top-desc">
                                                                <span><%= student.times %> 관왕</span>
                                                            </div>   
                                                        </div>
                                                        <% }) %>
                                                    </div>
                                                </div>
                                            <% } %>
                                    </div> <!-- end card-body-->
                                </div> <!-- end card-->
                            </div> <!-- end col-->

                        </div>
                        <!-- end row -->
                        <% }) %>

                    </div>
                </div>
            </div>
        </div>

        <!--  Add new task modal -->
        <div class="modal fade task-modal-content" id="tc-login" tabindex="-1" role="dialog" aria-labelledby="NewTaskModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">
                    <div class="modal-header">
                        <h4 class="modal-title" id="NewTaskModalLabel">선생님 인증</h4>
                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                    </div>
                    <div class="modal-body">
                        <form class="p-2" action="/auth/login" method="post">

                            <div class="row">
                                <div class="col-md-2"></div>
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label for="username">아이디</label>
                                        <input type="text" class="form-control form-control-light" name="username" placeholder="Enter username">
                                    </div>
                                </div>

                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label for="password">비밀번호</label>
                                        <input type="password" class="form-control form-control-light" name="password" placeholder="Enter password">
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-2"></div>
                            
                            <div class="text-right">
                                <button type="submit" class="btn btn-primary">로그인</button>
                            </div>
                        </form>
                    </div>
                </div><!-- /.modal-content -->
            </div><!-- /.modal-dialog -->
        </div><!-- /.modal -->

        <%- include('module/bundle'); %>

    </body>
</html>
